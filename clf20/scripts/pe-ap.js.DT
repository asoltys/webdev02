var PE={langu:'eng',progress:function(obj){this.domLoad(obj);},activateProgressEnhancement:function(obj){if(arguments.callee.done)return;arguments.callee.done=true;this.ua=new BrowserDetect();if(typeof obj.lng!='undefined')this.langu=obj.lng;if(typeof obj.pngfix!='undefined')this.pngFix(obj.pngfix);if(typeof obj.slideshow!='undefined')this.slideShow(obj.slideshow);if(typeof obj.flexbnnr!='undefined')this.adjustBanner(obj.flexbnnr);},fixMyPng:function(myImage,gifPath){var pngFile=myImage.src.substring(0,myImage.src.lastIndexOf('.'))+'.png';var blankGifLocation=gifPath;if((this.ua.isIE55||this.ua.isIE6x)&&this.ua.isWin32){myImage.style.visibility="hidden";myImage.runtimeStyle.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+pngFile+"', sizingMethod='scale')";myImage.src=blankGifLocation;myImage.style.visibility="visible";}else if((this.ua.isGecko)||(this.ua.isSafari)||(this.ua.isIE5up&&this.ua.isMac)||(this.ua.isOpera&&this.ua.isWin&&this.ua.versionMajor>=6)||(this.ua.isOpera&&this.ua.isUnix&&this.ua.versionMajor>=6)||(this.ua.isOpera&&this.ua.isMac&&this.ua.versionMajor>=5)||(this.ua.isOmniweb&&this.ua.versionMinor>=3.1)||(this.ua.isIcab&&this.ua.versionMinor>=1.9)||(this.ua.isWebtv)||(this.ua.isDreamcast)){myImage.src=pngFile;}},pngFix:function(gifPath){var pngArray=this.xGetElementsByClassName('pngfix');for(var i=0;i<pngArray.length;i++){var myPngToFix=pngArray[i];this.fixMyPng(myPngToFix,gifPath)}return 1;},slideShow:function(slideshowId,slideshowSpeed){window.SlideShowArray=new Array();var slideShowParentTag=this.xGetElementById(slideshowId);window.fadespeed=(typeof slideshowSpeed!="undefined")?slideshowSpeed:5;var promoItems=this.xGetElementsByTagName("li",slideShowParentTag);for(var item=0;item<promoItems.length;item++){var promolink=this.xGetElementsByTagName("img",promoItems[item]);if(promolink.length<1)continue;var promoLinkAnchor=this.xGetElementsByTagName("a",promoItems[item])[0];var promoLinkText=this.xGetElementsByTagName("a",promoItems[item])[1];promoLinkText.className="ss-active";var myFeature={src:promolink[0].src,alt:promolink[0].alt,url:promoLinkAnchor.href};window.SlideShowArray.push(myFeature);if(this.slideshowWieghtParser(promoItems[item].className)>0){for(var i=0;i<this.slideshowWieghtParser(promoItems[item].className);i++){this.addToSlideShowGracefully(myFeature);}};promoItems[item].className=promoItems[item].className.replace("menucontent","ss-active");promoItems[item].removeChild(this.xGetElementsByTagName("a",promoItems[item])[0]);promoItems[item].removeChild(this.xGetElementsByTagName("br",promoItems[item])[0]);}slideShowParentTag.parentNode.insertBefore(this.createSlideShowNode(window.SlideShowArray[0]),slideShowParentTag);},addToSlideShowGracefully:function(object){var insert=true;for(var i=0;i<window.SlideShowArray.length;i++){var oBefore=(i>0)?(i-1):i;if((window.SlideShowArray[oBefore].src!=object.src)&&(window.SlideShowArray[i].src!=object.src)&&insert){window.SlideShowArray.splice(i,0,object);insert=false;}}},slideshowWieghtParser:function(classinfo){if(classinfo.indexOf("ss-double")>-1)return 1;if(classinfo.indexOf("ss-triple")>-1)return 2;if(classinfo.indexOf("ss-quadruple")>-1)return 3;return 0;},createSlideShowNode:function(promoObj){var intefaceTitlePlay=(this.langu=="eng")?"Play":"Jouer";var intefaceTitlePause="Pause";var sNode=document.createElement("div");sNode.setAttribute("class","slideshowbanner");var aNode=document.createElement("a");aNode.setAttribute("id","slideshow-imagelink");aNode.setAttribute("href",promoObj.url);aNode.setAttribute("title",promoObj.alt);var iNode=document.createElement("img");iNode.setAttribute("id","slideshow-image");iNode.setAttribute("src",promoObj.src);iNode.setAttribute("alt",promoObj.src);window.slideShowImageNode=iNode;window.slideShowImageUrlNode=aNode;window.slideShowBaner=sNode;aNode.appendChild(iNode);sNode.appendChild(aNode);var cNode=document.createElement("div");cNode.setAttribute("class","slideshowcontrols");var paNode=document.createElement("a");paNode.setAttribute("id","slideshowplaylink");paNode.setAttribute("title",intefaceTitlePlay);paNode.style.cursor="pointer";this.addListener(paNode,"click",this.playSlideShow);var piNode=document.createElement("img");piNode.setAttribute("id","slideshowplaybutton");piNode.setAttribute("src","images/pla.jpg");piNode.setAttribute("alt",intefaceTitlePlay);paNode.appendChild(piNode);cNode.appendChild(paNode);var saNode=document.createElement("a");saNode.setAttribute("id","slideshowpauselink");saNode.setAttribute("title",intefaceTitlePause);saNode.style.cursor="pointer";var siNode=document.createElement("img");siNode.setAttribute("id","slideshowpausebutton");siNode.setAttribute("src","images/pau.jpg");siNode.setAttribute("alt",intefaceTitlePause);saNode.appendChild(siNode);cNode.appendChild(saNode);this.addListener(saNode,"click",this.pauseSlideShow);var mNode=document.createElement("div");mNode.setAttribute("id","slideshowContainer");mNode.appendChild(sNode);mNode.appendChild(cNode);window.SlideShowPlaying=false;window.currentSlide=0;setInterval("PE.nextSlide()",(window.fadespeed*1000));return mNode;},addListener:function(element,type,expression,bubbling){bubbling=bubbling||false;if(window.addEventListener){element.addEventListener(type,expression,bubbling);return true;}else if(window.attachEvent){element.attachEvent('on'+type,expression);return true;}else return false;},playSlideShow:function(){window.SlideShowPlaying=true;},pauseSlideShow:function(){window.SlideShowPlaying=false;},adjustBanner:function(divclass){if(this.ua.isSafari)return;var bannerNode=this.xGetElementsByClassName(divclass)[0];bannerNode.className+=' '+bannerNode.className+'-pe';var kids=bannerNode.childNodes;var lNode=bannerNode.removeChild(this.xGetElementsByClassName("lf",bannerNode)[0]);bannerNode.appendChild(lNode);for(var child=0;child<kids.length;child++){if(typeof kids[child].tagName=="undefined")continue;var tgName=new String(kids[child].tagName);if(tgName.toLowerCase()=="p"){kids[child].className+=' '+kids[child].className+'-pe';this.addBannerFixStyle(kids[child]);}}},addBannerFixStyle:function(tag){tag.style.width=(tag.className.indexOf("main")>-1)?"198px":"146px";tag.style.height="80px";tag.style.clear="none";if(this.ua.isIE5x){tag.style.top="0px";tag.style.position="absolute";tag.style.left=(tag.className.indexOf("main")>-1)?"auto":"10px";tag.style.right=(tag.className.indexOf("main")>-1)?"10px":"auto";tag.style.styleFloat="none";}else{tag.style.top="auto";tag.style.position="static";if(this.ua.isIE){tag.style.styleFloat=(tag.className.indexOf("main")>-1)?"right":"left";}else{tag.style.cssFloat=(tag.className.indexOf("main")>-1)?"right":"left";}}},xGetElementsByClassName:function(_className,_startElem,_filterTag){if(typeof _className==='string'){_className=new RegExp('(^| )'+_className+'( |$)');}_startElem=_startElem||document;_filterTag=_filterTag||'*';var arr=[];var tags;if(typeof _startElem.all!='undefined'&&_filterTag=='*'){tags=_startElem.all;}else{tags=_startElem.getElementsByTagName(_filterTag);}var i,len=tags.length;for(i=0;i<len;i++){var elem=tags[i];if(_className.test(elem.className)){arr.push(elem);}}return arr;},xGetElementsByTagName:function(t,p){var list=null;t=t||'*';p=p||document;if(this.ua.isIE4x||this.ua.isIE5x){if(t=='*')list=p.all;else list=p.all.tags(t);}else if(p.getElementsByTagName)list=p.getElementsByTagName(t);return list||new Array();},xGetElementById:function(e){if(typeof(e)=='string'){if(document.getElementById)e=document.getElementById(e);else if(document.all)e=document.all[e];else e=null;}return e;},nextSlide:function(){if(!window.SlideShowPlaying)return;if(window.currentSlide++==window.SlideShowArray.length-1)window.currentSlide=0;var ImageUrl=window.SlideShowArray[window.currentSlide].src;var ImageText=window.SlideShowArray[window.currentSlide].alt;var ImageHref=window.SlideShowArray[window.currentSlide].url;window.slideShowImageNode.src=ImageUrl;window.slideShowImageNode.alt=ImageText;window.slideShowImageUrlNode.href=ImageHref;window.slideShowImageUrlNode.title=ImageText;},blendimage:function(millisec){var speed=Math.round(millisec/100);var timer=0;window.slideShowBaner.style.backgroundImage="url("+window.slideShowImageNode.src+")";window.slideShowImageNode.style.opacity=(0);window.slideShowImageNode.style.MozOpacity=(0);window.slideShowImageNode.style.KhtmlOpacity=(0);window.slideShowImageNode.style.filter="alpha(opacity=0)";var ImageUrl=window.SlideShowArray[window.currentSlide].src;var ImageText=window.SlideShowArray[window.currentSlide].alt;var ImageHref=window.SlideShowArray[window.currentSlide].url;for(i=0;i<=100;i++){setTimeout("PE.setOpacity("+i+")",(timer*speed));timer++;}window.slideShowImageNode.src=ImageUrl;window.slideShowImageNode.alt=ImageText;window.slideShowImageUrlNode.href=ImageHref;window.slideShowImageUrlNode.title=ImageText;},setOpacity:function(opacity){window.SlideShowArray[window.currentSlide].style.opacity=(opacity/100);window.SlideShowArray[window.currentSlide].style.MozOpacity=(opacity/100);window.SlideShowArray[window.currentSlide].style.KhtmlOpacity=(opacity/100);window.SlideShowArray[window.currentSlide].style.filter="alpha(opacity="+opacity+")";},domLoad:function(obj){var _t=setInterval(function(){if(document.getElementsByTagName("body")[0]!=null||document.body!=null){PE.activateProgressEnhancement(obj);clearInterval(_t);}},250);if(typeof document.addEventListener!="undefined"){document.addEventListener("DOMContentLoaded",function(){PE.activateProgressEnhancement(obj);clearInterval(_t);},null);}}}
function BrowserDetect(){var ua=navigator.userAgent.toLowerCase();this.isGecko=(ua.indexOf('gecko')!=-1&&ua.indexOf('safari')==-1);this.isAppleWebKit=(ua.indexOf('applewebkit')!=-1);this.isKonqueror=(ua.indexOf('konqueror')!=-1);this.isSafari=(ua.indexOf('safari')!=-1);this.isOmniweb=(ua.indexOf('omniweb')!=-1);this.isOpera=(ua.indexOf('opera')!=-1);this.isIcab=(ua.indexOf('icab')!=-1);this.isAol=(ua.indexOf('aol')!=-1);this.isIE=(ua.indexOf('msie')!=-1&&!this.isOpera&&(ua.indexOf('webtv')==-1));this.isMozilla=(this.isGecko&&ua.indexOf('gecko/')+14==ua.length);this.isFirefox=(ua.indexOf('firefox/')!=-1||ua.indexOf('firebird/')!=-1);this.isNS=((this.isGecko)?(ua.indexOf('netscape')!=-1):((ua.indexOf('mozilla')!=-1)&&!this.isOpera&&!this.isSafari&&(ua.indexOf('spoofer')==-1)&&(ua.indexOf('compatible')==-1)&&(ua.indexOf('webtv')==-1)&&(ua.indexOf('hotjava')==-1)));this.isIECompatible=((ua.indexOf('msie')!=-1)&&!this.isIE);this.isNSCompatible=((ua.indexOf('mozilla')!=-1)&&!this.isNS&&!this.isMozilla);this.geckoVersion=((this.isGecko)?ua.substring((ua.lastIndexOf('gecko/')+6),(ua.lastIndexOf('gecko/')+14)):-1);this.equivalentMozilla=((this.isGecko)?parseFloat(ua.substring(ua.indexOf('rv:')+3)):-1);this.appleWebKitVersion=((this.isAppleWebKit)?parseFloat(ua.substring(ua.indexOf('applewebkit/')+12)):-1);this.versionMinor=parseFloat(navigator.appVersion);if(this.isGecko&&!this.isMozilla){this.versionMinor=parseFloat(ua.substring(ua.indexOf('/',ua.indexOf('gecko/')+6)+1));}else if(this.isMozilla){this.versionMinor=parseFloat(ua.substring(ua.indexOf('rv:')+3));}else if(this.isIE&&this.versionMinor>=4){this.versionMinor=parseFloat(ua.substring(ua.indexOf('msie ')+5));}else if(this.isKonqueror){this.versionMinor=parseFloat(ua.substring(ua.indexOf('konqueror/')+10));}else if(this.isSafari){this.versionMinor=parseFloat(ua.substring(ua.lastIndexOf('safari/')+7));}else if(this.isOmniweb){this.versionMinor=parseFloat(ua.substring(ua.lastIndexOf('omniweb/')+8));}else if(this.isOpera){this.versionMinor=parseFloat(ua.substring(ua.indexOf('opera')+6));}else if(this.isIcab){this.versionMinor=parseFloat(ua.substring(ua.indexOf('icab')+5));}this.versionMajor=parseInt(this.versionMinor);this.isDOM1=(document.getElementById);this.isDOM2Event=(document.addEventListener&&document.removeEventListener);this.mode=document.compatMode?document.compatMode:'BackCompat';this.isWin=(ua.indexOf('win')!=-1);this.isWin32=(this.isWin&&(ua.indexOf('95')!=-1||ua.indexOf('98')!=-1||ua.indexOf('nt')!=-1||ua.indexOf('win32')!=-1||ua.indexOf('32bit')!=-1||ua.indexOf('xp')!=-1));this.isMac=(ua.indexOf('mac')!=-1);this.isUnix=(ua.indexOf('unix')!=-1||ua.indexOf('sunos')!=-1||ua.indexOf('bsd')!=-1||ua.indexOf('x11')!=-1);this.isLinux=(ua.indexOf('linux')!=-1);this.isNS4x=(this.isNS&&this.versionMajor==4);this.isNS40x=(this.isNS4x&&this.versionMinor<4.5);this.isNS47x=(this.isNS4x&&this.versionMinor>=4.7);this.isNS4up=(this.isNS&&this.versionMinor>=4);this.isNS6x=(this.isNS&&this.versionMajor==6);this.isNS6up=(this.isNS&&this.versionMajor>=6);this.isNS7x=(this.isNS&&this.versionMajor==7);this.isNS7up=(this.isNS&&this.versionMajor>=7);this.isIE4x=(this.isIE&&this.versionMajor==4);this.isIE4up=(this.isIE&&this.versionMajor>=4);this.isIE5x=(this.isIE&&this.versionMajor==5);this.isIE55=(this.isIE&&this.versionMinor==5.5);this.isIE5up=(this.isIE&&this.versionMajor>=5);this.isIE6x=(this.isIE&&this.versionMajor==6);this.isIE6up=(this.isIE&&this.versionMajor>=6);this.isIE4xMac=(this.isIE4x&&this.isMac);}